<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Introduction | Coen </title> <meta name="author" content="Coen van den Elsen"> <meta name="description" content="A comprehensive guide to scaling machine learning from small to larger training setups."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%8D%89&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://coenvde.github.io/blogs/training-at-larger-scale/index/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Coen </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blogs/">Blogs <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Github </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <div class="toggle-nav-container"> <button class="toggle-nav" aria-label="Toggle navigation"> <span class="toggle-nav-icon"></span> <span class="toggle-nav-text">Toggle navigation</span> </button> </div> <h1 class="post-title">Introduction</h1> <p class="post-description">A comprehensive guide to scaling machine learning from small to larger training setups.</p> </header> <div class="row"> <div class="col-sm-12 col-md-3 blog-sidebar"> <div class="sidebar-sticky"> <div class="collection-link"> <a href="/blogs/" class="back-to-collection"> <i class="fas fa-arrow-left"></i> Back to Collections </a> </div> <h3>Contents</h3> <div class="toc-container"> <ul class="blog-nav-list"> <li class="blog-nav-item active"> <a href="/blogs/training-at-larger-scale/index/"> Introduction </a> </li> <li class="blog-nav-item"> <a href="/blogs/training-at-larger-scale/part1/"> Ch 1: The Setup </a> </li> <li class="blog-nav-item"> <a href="/blogs/training-at-larger-scale/part2/"> Ch 2: Multi-GPU training </a> </li> <li class="blog-nav-item"> <a href="/blogs/training-at-larger-scale/part3/"> Ch 3: Bigger data in the cloud </a> </li> <li class="blog-nav-item"> <a href="/blogs/training-at-larger-scale/part4/"> Ch 4: Optimizing the pipeline: Data </a> </li> <li class="blog-nav-item"> <a href="/blogs/training-at-larger-scale/part5/"> Ch 5: Optimizing the pipeline: Model </a> </li> <li class="blog-nav-item"> <a href="/blogs/training-at-larger-scale/part6/"> Ch 6: What Is Next </a> </li> </ul> </div> <style>.collection-link{margin-bottom:15px;padding-bottom:15px;border-bottom:1px solid var(--global-divider-color)}.back-to-collection{display:block;padding:8px 10px;background-color:var(--global-code-bg-color);border-radius:4px;text-decoration:none;transition:background-color .3s ease}.back-to-collection:hover{background-color:var(--global-hover-color);text-decoration:none}.toc-container{padding:.5rem 0}.blog-nav-item a{display:block;text-decoration:none;color:var(--global-text-color)}.blog-nav-item:hover a{text-decoration:none}.blog-nav-item.active a{text-decoration:none}</style> </div> </div> <div class="col-sm-12 col-md-9 blog-content"> <article> <h1 id="training-at-larger-scale">Training at larger scale</h1> <h3 id="why-am-i-writing-this">Why am I writing this?</h3> <p>At university, in online blogs, and across tutorials, training machine learning models is often well explained—especially for small-scale setups. These typically involve datasets that fit on a local hard drive, training on a single GPU, and straightforward implementations without worrying about fast data loading, datasets that do not fit onto a local hard drive (lazy loading), or multi-GPU utilization/optimization.</p> <p>However, when transitioning to a larger setup —not massive SOTA-scale training across thousands of GPUs with internet-scale data, but something in between— good resources are harder to find and are scattered around. I call this the “larger-scale training” realm: working with datasets that are a few terabytes (too large for local storage but far from internet-scale) and training across multiple GPUs (around 10, not 100s or 1000s).</p> <div align="center"> <img src="/images/training-blog/intro_image_larger_scale.png" alt="Scaling up training" width="400"> <br> <p><em>Illustration of larger-scale training</em></p> </div> <div align="right"> <small>Source: Created with ChatGPT</small> </div> <p>For my research, I need to scale up my training to this realm, but I struggle to find practical, well-structured guides on bridging the gap from small-scale to mid-sized, high-performance training. This larger-scale training” is where a lot of valuable research and development happens, yet optimization and implementation for this space are harder to figure out. Maximizing hardware efficiency at this level can significantly reduce training time, costs and environmental impact.</p> <p>This guide is for those stepping into this space —researchers and practitioners who want to scale their training beyond a single GPU while making the most of the resources they have. My experience comes from working with geospatial data, so some examples may be domain-specific, but the core principles apply broadly across all machine learning applications that make use of pytorch.</p> <p>I want to note that this is not a definitive guide on how everything should be done. Instead, it’s a collection of challenges I faced and the solutions I found along the way. I encourage you to ask questions, share feedback, and suggest improvements — the goal is to learn from each other and train more efficiently every day :)</p> <p>This blog is available on <a href="https://github.com/coenvde/training-at-larger-scale-blog" rel="external nofollow noopener" target="_blank">GitHub</a> as well as my <a href="https://coenvde.github.io/blogs/training-at-larger-scale/index/" rel="external nofollow noopener" target="_blank">website</a>. For every chapter, I created a folder on GitHub with all full code. The markdown files are available on both platforms, containing text and code examples.</p> <h2 id="whats-next">What’s next</h2> <p>I’ll walk you through my process of implementing and optimizing everything. Each chapter folder contains code examples that demonstrate the concepts discussed in the corresponding markdown file. To run the examples, navigate to the specific chapter folder on GitHub and follow the instructions as specified in the markdown files. I strongly advise to run through them in order, as they build on top of each other and I expect previous chapters as background knowledge for the following one. I especially encourage you to get familiar with pytorch lightning (<a href="/blogs/training-at-larger-scale/part2/">1. Multi-GPU training</a>) as it will streamline, improve and speed up your workflow a lot.</p> <h2 id="chapters">Chapters</h2> <ol> <li> <a href="/blogs/training-at-larger-scale/part1/">0. The Setup</a> - Overview of the initial setup as a starting point</li> <li> <a href="/blogs/training-at-larger-scale/part2/">1. Multi-GPU training</a> - Scaling from a single GPU to multiple GPUs and using Lightning for better code</li> <li> <a href="/blogs/training-at-larger-scale/part3/">2. Bigger data in the cloud</a> - Working with bigger data</li> <li> <a href="/blogs/training-at-larger-scale/part4/">3. Optimizing the pipeline: Data</a> - Optimizing: Maximizing DataLoader efficiency</li> <li> <a href="/blogs/training-at-larger-scale/part5/">4. Optimizing the pipeline: Model</a> - Optimizing: Profiling and fixing slowdowns</li> <li> <a href="/blogs/training-at-larger-scale/part6/">5. What Is Next</a> - Further optimizations, experiments and improvements as the final step before training</li> </ol> <h2 id="installation">Installation</h2> <ol> <li> <p><strong>Clone the repository:</strong></p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>git clone https://github.com/CoenvdE/Training-at-larger-scale-blog.git
<span class="nb">cd </span>Training-at-larger-scale-blog
</code></pre></div> </div> </li> <li> <p><strong>Install uv (if you haven’t already):</strong></p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>uv
</code></pre></div> </div> <p>Or, for other installation methods, see the <a href="https://astral.sh/uv/install.sh" rel="external nofollow noopener" target="_blank">uv documentation</a>.</p> </li> <li> <p><strong>Create a virtual environment and install dependencies:</strong></p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>uv venv
uv <span class="nb">sync</span>
</code></pre></div> </div> <p>This will create a virtual environment in <code class="language-plaintext highlighter-rouge">.venv</code> and install all necessary packages.</p> </li> <li> <p><strong>Run the code:</strong></p> <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>uv run python your_script.py
</code></pre></div> </div> <p>This will run your Python script in the virtual environment with all dependencies available.</p> </li> </ol> <h2>Contents</h2> <div class="chapters-container"> <div class="chapter-card"> <div class="chapter-number"> Chapter 1 </div> <h3 class="chapter-title"> <a href="/blogs/training-at-larger-scale/part1/">The Setup</a> </h3> <p class="chapter-description">Chapter 1 of the Training at Larger Scale series</p> <a href="/blogs/training-at-larger-scale/part1/" class="read-chapter-btn">Read Chapter →</a> </div> <div class="chapter-card"> <div class="chapter-number"> Chapter 2 </div> <h3 class="chapter-title"> <a href="/blogs/training-at-larger-scale/part2/">Multi-GPU training</a> </h3> <p class="chapter-description">Chapter 2 of the Training at Larger Scale series</p> <a href="/blogs/training-at-larger-scale/part2/" class="read-chapter-btn">Read Chapter →</a> </div> <div class="chapter-card"> <div class="chapter-number"> Chapter 3 </div> <h3 class="chapter-title"> <a href="/blogs/training-at-larger-scale/part3/">Bigger data in the cloud</a> </h3> <p class="chapter-description">Chapter 3 of the Training at Larger Scale series</p> <a href="/blogs/training-at-larger-scale/part3/" class="read-chapter-btn">Read Chapter →</a> </div> <div class="chapter-card"> <div class="chapter-number"> Chapter 4 </div> <h3 class="chapter-title"> <a href="/blogs/training-at-larger-scale/part4/">Optimizing the pipeline: Data</a> </h3> <p class="chapter-description">Chapter 4 of the Training at Larger Scale series</p> <a href="/blogs/training-at-larger-scale/part4/" class="read-chapter-btn">Read Chapter →</a> </div> <div class="chapter-card"> <div class="chapter-number"> Chapter 5 </div> <h3 class="chapter-title"> <a href="/blogs/training-at-larger-scale/part5/">Optimizing the pipeline: Model</a> </h3> <p class="chapter-description">Chapter 5 of the Training at Larger Scale series</p> <a href="/blogs/training-at-larger-scale/part5/" class="read-chapter-btn">Read Chapter →</a> </div> <div class="chapter-card"> <div class="chapter-number"> Chapter 6 </div> <h3 class="chapter-title"> <a href="/blogs/training-at-larger-scale/part6/">What Is Next</a> </h3> <p class="chapter-description">Chapter 6 of the Training at Larger Scale series</p> <a href="/blogs/training-at-larger-scale/part6/" class="read-chapter-btn">Read Chapter →</a> </div> </div> <style>.chapters-container{display:flex;flex-direction:column;gap:1.5rem;margin:2rem 0}.chapter-card{padding:1.5rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.08);transition:all .3s ease;background-color:var(--global-card-bg-color);border:1px solid var(--global-divider-color)}.chapter-card:hover{box-shadow:0 5px 15px rgba(0,0,0,0.1);transform:translateY(-2px)}.chapter-number{font-weight:bold;color:var(--global-text-color-light);margin-bottom:.5rem;font-size:.9rem}.chapter-title{margin-top:0;margin-bottom:.8rem;font-size:1.5rem}.chapter-title a{color:var(--global-theme-color);text-decoration:none}.chapter-title a:hover{text-decoration:underline}.chapter-description{margin-bottom:1.2rem;color:var(--global-text-color);line-height:1.5}.read-chapter-btn{display:inline-block;padding:.5rem 1rem;background-color:var(--global-code-bg-color);color:var(--global-text-color);border-radius:4px;text-decoration:none;font-weight:500;transition:background-color .3s ease}.read-chapter-btn:hover{background-color:var(--global-hover-color);text-decoration:none}</style> </article> </div> </div> </div> <style>.blog-sidebar{border-right:1px solid var(--global-divider-color);padding-right:20px}.sidebar-sticky{position:sticky;top:4rem;height:calc(100vh - 6rem);overflow-y:auto}.blog-nav-list{list-style-type:none;padding-left:0;margin-top:15px}.blog-nav-item{margin-bottom:10px;padding:5px 10px;border-radius:4px;transition:background-color .3s ease}.blog-nav-item:hover{background-color:var(--global-hover-color)}.blog-nav-item.active{background-color:var(--global-theme-color);font-weight:bold}.blog-nav-item.active a{color:white}.collection-link{margin-bottom:15px;padding-bottom:15px;border-bottom:1px solid var(--global-divider-color)}.back-to-collection{display:block;padding:8px 10px;background-color:var(--global-code-bg-color);border-radius:4px;text-decoration:none;transition:background-color .3s ease}.back-to-collection:hover{background-color:var(--global-hover-color);text-decoration:none}.chapters-container{display:flex;flex-direction:column;gap:20px;margin:30px 0}.chapter-card{padding:20px;border-radius:8px;box-shadow:0 2px 5px rgba(0,0,0,0.1);transition:all .3s ease;position:relative;background-color:var(--global-card-bg-color)}.chapter-card:hover{box-shadow:0 5px 15px rgba(0,0,0,0.1);transform:translateY(-2px)}.chapter-number{font-weight:bold;color:var(--global-text-color-light);margin-bottom:5px}.chapter-title{margin-top:0;margin-bottom:10px;color:var(--global-theme-color)}.chapter-description{margin-bottom:15px;color:var(--global-text-color)}.toggle-nav-container{text-align:right;margin-bottom:1rem}.toggle-nav{display:inline-block;background:transparent;border:0;cursor:pointer;padding:.5rem;font-size:.9rem;color:var(--global-text-color)}.toggle-nav-icon{display:inline-block;width:1.25rem;height:2px;background-color:var(--global-text-color);position:relative;margin-right:.5rem;vertical-align:middle}.toggle-nav-icon:before,.toggle-nav-icon:after{content:'';display:block;width:100%;height:2px;background-color:var(--global-text-color);position:absolute;left:0}.toggle-nav-icon:before{top:-6px}.toggle-nav-icon:after{bottom:-6px}.toggle-nav-text{vertical-align:middle}@media(max-width:768px){.blog-sidebar{border-right:0;border-bottom:1px solid var(--global-divider-color);margin-bottom:20px;padding-bottom:20px}.sidebar-sticky{position:relative;height:auto;overflow-y:visible}.blog-nav-list{display:flex;flex-wrap:wrap;gap:10px}.blog-nav-item{margin-bottom:0}}</style> <script>
  document.addEventListener('DOMContentLoaded', function () {
    const toggleBtn = document.querySelector('.toggle-nav');
    const sidebar = document.querySelector('.blog-sidebar');
    const content = document.querySelector('.blog-content');

    if (toggleBtn && sidebar && content) {
      toggleBtn.addEventListener('click', function () {
        if (sidebar.style.display === 'none') {
          sidebar.style.display = 'block';
          content.classList.remove('col-md-12');
          content.classList.add('col-md-9');
        } else {
          sidebar.style.display = 'none';
          content.classList.remove('col-md-9');
          content.classList.add('col-md-12');
        }
      });
    }
  });
</script> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Coen van den Elsen. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>